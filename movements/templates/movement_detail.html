{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Movement Detail" %}{% endblock title %}

{% block body %}
  <div class="main-container">
    <div class="detail-container">
      <h2 class="detail-title">{% trans "Details of Stock movement" %}</h2>
      
      <div class="space-y-4 text-gray-800 dark:text-gray-300">
        <div>
          <span class="detail-text">{% trans "Responsible" %}:</span>
          <span class="text-lg">{{ movement.user }}</span>
        </div>

        <div>
          <span class="detail-text">{% trans "Type" %}:</span>
          <span class="text-lg">{{ movement.get_type_display }}</span>
        </div>

        <div>
          <span class="detail-text">{% trans "Date" %}:</span>
          <span class="text-lg">{{ movement.date|date:"d/m/Y H:i:s" }}</span>
        </div>

        {% if movement.type == "in" %}
          <div>
            <span class="detail-text mb-2">{% trans "Ingredients" %}:</span>
            <div class="overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
              <table class="detail-table">
                <thead class="detail-thead">
                  <tr>
                    <th class="detail-th">{% trans "Name" %}</th>
                    <th class="detail-th">{% trans "Price" %}</th>
                    <th class="detail-th">{% trans "Amount" %}</th>
                  </tr>
                </thead>
                <tbody class="detail-tbody">
                  {% for ingredient in movement.ingredients.all %}
                    <tr class="table-row">
                      <td class="px-4 py-2">{{ ingredient.name }}</td>
                      <td class="px-4 py-2">R$ {{ ingredient.price }}</td>
                      <td class="px-4 py-2">
                        {% if ingredient.measure == "kg" %}
                          {{ ingredient.quantity }} {{ ingredient.get_measure_display }}
                        {% else %}
                          {{ ingredient.quantity|floatformat:0 }} {{ ingredient.get_measure_display }}
                        {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        {% else %}
          <div>
            <span class="detail-text mb-2">{% trans "Products" %}:</span>
            <div class="overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
              <table class="detail-table">
                <thead class="detail-thead">
                  <tr>
                    <th class="detail-th">{% trans "Name" %}</th>
                    <th class="detail-th">{% trans "Amount" %}</th>
                    <th class="detail-th">{% trans "Price" %}</th>
                  </tr>
                </thead>
                <tbody class="detail-tbody">
                  {% for product in movement.products.all %}
                    <tr class="table-row">
                      <td class="px-4 py-2">{{ product.name }}</td>
                      <td class="px-4 py-2">{{ product.quantity }}</td>
                      <td class="px-4 py-2">R$ {{ product.price }}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        {% endif %}

        <div>
          <span class="detail-text">Total:</span>
          {% if movement.type == "in" %}
            <span class="text-lg font-semibold text-red-600">-R$ {{ movement.value }}</span>
          {% else %}
            <span class="text-lg font-semibold text-green-600">+R$ {{ movement.value }}</span>
          {% endif %}
        </div>

        <div>
          <span class="detail-text">{% trans "Commentary" %}:</span>
          <span class="text-lg">{{ movement.commentary }}</span>
        </div>
      </div>

      <div class="detail-buttons">
        <a href="{% url 'movement_list' %}" class="gray-button">{% trans "Back to List" %}</a>
        <a href="{% url 'movement_delete' movement.id %}" class="red-button">{% trans "Delete" %}</a>
      </div>
      
    </div>
  </div>
{% endblock body %}
